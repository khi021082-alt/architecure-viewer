<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì•„ì‚¬ì¿ ì‚¬ ë¯¸ì¿ ì§€ - ë²šê½ƒ ì—ë””ì…˜</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@400;700&display=swap');

        :root {
            --primary-pink: #FF8BA7;
            --deep-pink: #FF5D8F;
            --soft-cream: #FFFCF2;
            --sakura-white: #FFE4E1;
            --lantern-red: #E53935;
            --wood-brown: #8D6E63;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            /* í•‘í¬ë¹› í•˜ëŠ˜ ë°°ê²½ */
            background: linear-gradient(180deg, #ffe6eb 0%, #ffd1dc 100%);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: #555;
            overflow: hidden;
            position: relative;
        }

        /* ë²šê½ƒ íš¨ê³¼ (ê°œìˆ˜ ì¦ê°€) */
        .sakura-container {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 20; /* ë§¨ ìœ„ë¡œ */
            overflow: hidden;
        }

        .petal {
            position: absolute;
            background-color: #FFB7C5;
            border-radius: 150% 0 150% 0;
            opacity: 0.8;
            animation: fall linear infinite;
        }

        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        .container {
            width: 100%;
            max-width: 420px;
            background: var(--soft-cream);
            border-radius: 30px;
            box-shadow: 0 15px 35px rgba(255, 93, 143, 0.2);
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden; /* ë°°ê²½ ê·¸ë¦¼ì´ íŠ€ì–´ë‚˜ê°€ì§€ ì•Šê²Œ */
            min-height: 700px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            border: 5px solid var(--primary-pink);
            z-index: 10;
        }

        /* === [CSS ê·¸ë¦¼] ì•„ì‚¬ì¿ ì‚¬ ë°°ê²½ ì•„íŠ¸ === */
        .asakusa-art {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0; /* ì»¨í…ì¸  ë’¤ë¡œ */
            pointer-events: none;
            opacity: 0.9;
        }

        /* ì§€ë¶• */
        .art-roof {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 320px;
            height: 60px;
            background: var(--wood-brown);
            border-radius: 30px 30px 5px 5px;
            box-shadow: 0 5px 0 #5D4037;
        }
        .art-roof::before { /* ì§€ë¶• ì¥ì‹ */
            content: ""; position: absolute; top: 10px; left: 20px; right: 20px; height: 5px; background: #A1887F; border-radius: 5px;
        }

        /* ê¸°ë‘¥ */
        .art-pillar {
            position: absolute;
            top: 80px;
            width: 25px;
            height: 180px;
            background: var(--lantern-red);
            border-radius: 5px;
        }
        .p-left { left: 60px; }
        .p-right { right: 60px; }

        /* ëŒ€í˜• ì œë“± (ì¹´ë¯¸ë‚˜ë¦¬ëª¬) */
        .art-lantern {
            position: absolute;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            width: 160px;
            height: 180px;
            background: var(--lantern-red);
            border-radius: 40px;
            border-top: 10px solid #333;
            border-bottom: 20px solid #D4AF37; /* ê¸ˆìƒ‰ ì¥ì‹ */
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        /* ì œë“± ì¤„ë¬´ëŠ¬ */
        .art-lantern::before {
            content: "";
            position: absolute;
            width: 100%; height: 100%;
            background: repeating-linear-gradient(transparent, transparent 30px, rgba(0,0,0,0.1) 30px, rgba(0,0,0,0.1) 32px);
            border-radius: 40px;
        }
        /* ì œë“± ê¸€ì”¨ */
        .lantern-kanji {
            font-family: 'Gowun Batang', serif;
            font-size: 3.5rem;
            color: #000;
            font-weight: bold;
            text-shadow: 1px 1px 0 rgba(255,255,255,0.3);
            z-index: 1;
        }

        /* ë²šê½ƒ ë‚˜ë¬´ (ë°°ê²½) */
        .art-tree {
            position: absolute;
            bottom: 0;
            width: 120px;
            height: 150px;
        }
        .t-left { left: -30px; }
        .t-right { right: -30px; transform: scaleX(-1); }

        .tree-trunk {
            position: absolute;
            bottom: 0; left: 50%;
            width: 15px; height: 100px;
            background: var(--wood-brown);
            border-radius: 5px;
        }
        .tree-leaves {
            position: absolute;
            bottom: 60px; left: 10px;
            width: 100px; height: 100px;
            background: #FFB7C5;
            border-radius: 50%;
            box-shadow: 20px -10px 0 #FFC1CC, -20px 10px 0 #FFCDD2;
        }

        /* === ì»¨í…ì¸  ìŠ¤íƒ€ì¼ === */
        h1 {
            font-family: 'Jua', sans-serif;
            color: var(--deep-pink);
            font-size: 2.8rem;
            margin: 180px 0 10px; /* ê·¸ë¦¼ ì•„ë˜ë¡œ ë°€ê¸° */
            text-shadow: 2px 2px 0 #FFF;
            position: relative;
            z-index: 5;
        }

        .desc {
            color: #888;
            margin-bottom: 20px;
            font-size: 1.2rem;
            font-family: 'Jua', sans-serif;
            position: relative;
            z-index: 5;
        }

        .scene {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
            height: 100%;
            position: relative;
            z-index: 5; /* ë°°ê²½ ìœ„ë¡œ */
        }
        
        .scene.active { 
            display: flex; 
            animation: fadeIn 0.5s ease;
        }

        /* í†µ í”ë“¤ê¸° ìŠ¤íƒ€ì¼ (ê·€ì—½ê²Œ ìˆ˜ì •) */
        .omikuji-cylinder {
            width: 110px;
            height: 200px;
            background: #FFF;
            border: 4px solid var(--primary-pink);
            border-radius: 20px;
            position: relative;
            margin: 10px auto 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 5px 5px 0 rgba(255, 93, 143, 0.1);
            transform-origin: bottom center;
        }
        
        .omikuji-cylinder::before { /* ìœ¡ê° ëšœê»‘ ëŠë‚Œ */
            content: "";
            position: absolute; top: -15px;
            width: 90px; height: 20px;
            background: var(--primary-pink);
            border-radius: 10px;
        }

        .omikuji-text {
            font-family: 'Jua', sans-serif;
            font-size: 2.5rem;
            color: var(--deep-pink);
            writing-mode: vertical-rl;
            text-orientation: upright;
        }

        .shake-action { animation: tiltShake 0.6s ease-in-out infinite; }
        @keyframes tiltShake {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(20deg); }
            50% { transform: rotate(0deg); }
            75% { transform: rotate(-20deg); }
            100% { transform: rotate(0deg); }
        }

        .btn {
            background-color: var(--deep-pink);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.3rem;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Jua', sans-serif;
            transition: all 0.2s;
            box-shadow: 0 5px 0 #C2185B;
        }
        .btn:hover { transform: translateY(-3px); background-color: #FF4081; }
        .btn:active { transform: translateY(2px); box-shadow: none; }

        /* ì œë¹„ ìŠ¤íƒ€ì¼ */
        .sticks-container {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-top: 20px;
            height: 180px;
            align-items: flex-end;
        }
        .stick {
            width: 25px; height: 150px;
            background: #FFF;
            border: 3px solid var(--wood-brown);
            border-radius: 10px;
            cursor: pointer;
            position: relative;
            box-shadow: 3px 3px 0 rgba(0,0,0,0.1);
            opacity: 0;
            transform: translateY(-50px);
            animation: stickDrop 0.5s ease forwards;
        }
        .stick::after { /* ëë¶€ë¶„ ë¹¨ê°• */
            content: ""; position: absolute; bottom: 5px; left: 2px; right: 2px; height: 30px; 
            background: var(--deep-pink); border-radius: 5px;
        }
        .stick:hover { transform: translateY(-20px) !important; background: #FFF0F5; }
        @keyframes stickDrop { to { opacity: 1; transform: translateY(0); } }

        /* ì„œëì¥ */
        .drawer-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 6px;
            margin: 10px auto;
            background: var(--wood-brown);
            padding: 10px;
            border-radius: 15px;
            width: 90%;
        }
        .drawer {
            height: 35px;
            background: #FFF;
            color: var(--wood-brown);
            border-radius: 5px;
            font-family: 'Jua';
            font-size: 1rem;
            display: flex; justify-content: center; align-items: center;
            cursor: pointer;
            box-shadow: 0 2px 0 rgba(0,0,0,0.1);
        }
        .drawer.target {
            border: 2px solid var(--deep-pink);
            color: var(--deep-pink);
            animation: pulse 1s infinite;
        }

        /* ê²°ê³¼ ì¢…ì´ */
        .paper {
            width: 85%;
            background: #FFF;
            padding: 25px;
            border-radius: 10px;
            border: 2px dashed var(--primary-pink);
            margin-bottom: 10px;
            margin-top: 100px; /* ê·¸ë¦¼ í”¼í•˜ê¸° */
        }
        .fortune-rank {
            font-family: 'Jua', serif;
            font-size: 3rem; margin: 10px 0; color: var(--deep-pink);
        }
        .fortune-text { font-size: 1.1rem; line-height: 1.6; margin: 15px 0; font-weight: 500; }

        /* ì•¡ìš´ ë¬¶ê¸° ì˜ì—­ */
        #bad-luck-action {
            width: 100%;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            padding: 15px;
            margin-top: 5px;
            border: 2px solid var(--primary-pink);
        }
        
        /* ë¬¶ëŠ” ê¸°ë‘¥ ìŠ¤íƒ€ì¼ */
        .wires-frame {
            position: relative; width: 100%; height: 120px; margin: 10px 0;
            display: flex; justify-content: space-between;
        }
        .pillar {
            width: 12px; height: 100%; background: var(--lantern-red); border-radius: 10px;
        }
        .wires-container {
            position: absolute; top: 0; left: 12px; right: 12px; height: 100%;
            display: flex; flex-direction: column; justify-content: space-evenly;
        }
        .wire {
            width: 100%; height: 3px; background: #CCC;
        }
        .tied-paper {
            width: 35px; height: 10px; background: #FFF;
            position: absolute; top: 50%; border: 1px solid #ddd;
            transform: translateY(-50%) rotate(-5deg);
        }
        .tied-paper::before, .tied-paper::after {
            content: ""; position: absolute; background: #FFF; width: 10px; height: 25px; top: 3px; border: 1px solid #ddd;
        }
        .tied-paper::before { left: -3px; transform: rotate(30deg); }
        .tied-paper::after { right: -3px; transform: rotate(-30deg); }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        @keyframes fall {
            0% { opacity: 0; top: -10%; transform: translateX(0) rotate(0deg); }
            20% { opacity: 1; }
            100% { opacity: 0; top: 100%; transform: translateX(30px) rotate(180deg); }
        }

        .hidden { display: none !important; }
    </style>
</head>
<body>
    <div class="sakura-container" id="sakura-container"></div>

    <div class="container">
        <!-- ë°°ê²½ ì•„íŠ¸ (CSS ê·¸ë¦¼) -->
        <div class="asakusa-art">
            <!-- ì§€ë¶• -->
            <div class="art-roof"></div>
            <!-- ì™¼ìª½ ê¸°ë‘¥ -->
            <div class="art-pillar p-left"></div>
            <!-- ì˜¤ë¥¸ìª½ ê¸°ë‘¥ -->
            <div class="art-pillar p-right"></div>
            <!-- ì œë“± (ì¹´ë¯¸ë‚˜ë¦¬ëª¬) -->
            <div class="art-lantern">
                <span class="lantern-kanji">é›·é–€</span>
            </div>
            <!-- ë²šê½ƒ ë‚˜ë¬´ -->
            <div class="art-tree t-left">
                <div class="tree-leaves"></div>
                <div class="tree-trunk"></div>
            </div>
            <div class="art-tree t-right">
                <div class="tree-leaves"></div>
                <div class="tree-trunk"></div>
            </div>
        </div>

        <!-- Scene 1: Start -->
        <div id="scene-start" class="scene active">
            <h1>ì˜¤ëŠ˜ì˜ ìš´ì„¸</h1>
            <p class="desc">í•‘í¬ë¹› í–‰ìš´ì´ ê°€ë“!<br>í†µì„ í”ë“¤ì–´ë³´ì„¸ìš”!</p>
            <div class="omikuji-cylinder" id="box">
                <span class="omikuji-text">é‹å‹¢</span>
            </div>
            <button class="btn" onclick="startShaking()">ìš´ì„¸í†µ í”ë“¤ê¸°</button>
        </div>

        <!-- Scene 2: Choose Stick -->
        <div id="scene-stick" class="scene">
            <h1 style="margin-top:100px;">ì œë¹„ ë½‘ê¸°</h1> <!-- ê·¸ë¦¼ í”¼í•˜ê¸° ìœ„í•´ ë§ˆì§„ ì¡°ì • -->
            <p class="desc">ê°€ì¥ ë§ˆìŒì— ë“œëŠ” ê±¸ë¡œ ì™!</p>
            <div class="sticks-container">
                <div class="stick" onclick="pickStick(this)" style="animation-delay: 0.1s"></div>
                <div class="stick" onclick="pickStick(this)" style="animation-delay: 0.3s"></div>
                <div class="stick" onclick="pickStick(this)" style="animation-delay: 0.0s"></div>
                <div class="stick" onclick="pickStick(this)" style="animation-delay: 0.2s"></div>
                <div class="stick" onclick="pickStick(this)" style="animation-delay: 0.15s"></div>
            </div>
        </div>

        <!-- Scene 3: Open Drawer -->
        <div id="scene-drawer" class="scene">
            <h1 style="margin-top:100px;">ì„œë ì—´ê¸°</h1>
            <p class="desc"><b id="stick-num-display" style="color:var(--deep-pink); font-size:1.5rem;"></b>ë²ˆ ì„œëì„ ì°¾ì•„ì£¼ì„¸ìš”!</p>
            <div class="drawer-grid" id="drawer-grid"></div>
        </div>

        <!-- Scene 4: Result -->
        <div id="scene-result" class="scene">
            <div class="paper" id="result-paper">
                <div style="border-bottom: 2px dashed #FFB7C5; padding-bottom:5px; margin-bottom:10px;">
                    <span style="font-family: 'Jua'; color:#888;">No. <span id="result-num"></span></span>
                </div>
                <div class="fortune-rank" id="fortune-rank">ëŒ€ê¸¸</div>
                <p class="fortune-text" id="fortune-text">
                    ê¸°ë‹¤ë¦¬ë˜ ì†Œì‹ì´ ì˜¤ê³ <br>ê¸°ì¨ì´ ë„˜ì¹˜ëŠ” í•˜ë£¨ì…ë‹ˆë‹¤.
                </p>
                <div style="font-size: 1rem; color: #555; background: #FFF0F5; padding: 8px; border-radius: 10px;">
                    <b>ğŸŒ¸ í–‰ìš´í…œ:</b> <span id="lucky-item">ë¶€ì </span>
                </div>
            </div>
            
            <!-- ì•¡ìš´ ë¬¶ê¸° ì˜ì—­ -->
            <div id="bad-luck-action" class="hidden">
                <p style="font-family:'Jua'; color: var(--wood-brown); margin: 0 0 10px 0;">
                    ë‚˜ìœ ìš´ì€ ì—¬ê¸°ì— ë¬¶ì–´ë‘ê³ ,<br>ê°€ë²¼ìš´ ë§ˆìŒìœ¼ë¡œ ê°€ì„¸ìš”!
                </p>
                
                <div class="wires-frame">
                    <div class="pillar"></div>
                    <div class="wires-container" id="wires-container"></div>
                    <div class="pillar"></div>
                </div>

                <button class="btn" id="tie-btn" onclick="tieBadLuck()">
                    ê¼­ê¼­ ë¬¶ì–´ë‘ê¸°
                </button>
            </div>

            <button class="btn" id="retry-btn" onclick="location.reload()" style="margin-top: 15px; background-color: #81D4FA; box-shadow: 0 5px 0 #29B6F6;">
                ë‹¤ì‹œ í•˜ê¸°
            </button>
        </div>
    </div>

    <script>
        // ë²šê½ƒ ëŒ€í­ë°œ! ê°œìˆ˜ ëŠ˜ë¦¼
        function createSakura() {
            const container = document.getElementById('sakura-container');
            const petalCount = 60; // 30ê°œ -> 60ê°œë¡œ 2ë°° ì¦ê°€
            for (let i = 0; i < petalCount; i++) {
                const petal = document.createElement('div');
                petal.className = 'petal';
                const size = Math.random() * 10 + 8 + 'px'; // ê½ƒì í¬ê¸° ì•½ê°„ í‚¤ì›€
                petal.style.width = size; petal.style.height = size;
                petal.style.left = Math.random() * 100 + '%';
                petal.style.animationDuration = Math.random() * 4 + 3 + 's'; // ì²œì²œíˆ ë–¨ì–´ì§€ê²Œ
                petal.style.animationDelay = Math.random() * 5 + 's';
                container.appendChild(petal);
            }
        }
        createSakura();

        const fortunes = [
            { type: "ëŒ€ê¸¸ (å¤§å‰)", text: "ì–´ë¨¸! ì˜¤ëŠ˜ì€ ìµœê³ ì˜ ë‚ ì´ì—ìš”! ğŸŒ¸<br>ì›í•˜ë˜ ëª¨ë“  ì¼ì´ ì´ë£¨ì–´ì§ˆ ê±°ì˜ˆìš”.", item: "í•‘í¬ìƒ‰ ë¦½ë°¤", isBad: false },
            { type: "ê¸¸ (å‰)", text: "ê¸°ë¶„ ì¢‹ì€ ì¼ì´ ìƒê¸¸ ê±°ì˜ˆìš”.<br>ë…¸ë ¥í•œ ë§Œí¼ ë°˜ì§ë°˜ì§ ë¹›ë‚  ê±°ì˜ˆìš”.", item: "ìƒˆ ë‹¤ì´ì–´ë¦¬", isBad: false },
            { type: "ì¤‘ê¸¸ (ä¸­å‰)", text: "ë§ˆìŒì´ í¸ì•ˆí•œ í•˜ë£¨ì˜ˆìš”.<br>ë”°ëœ»í•œ ì°¨ í•œ ì”ì˜ ì—¬ìœ ë¥¼ ì¦ê²¨ë³´ì„¸ìš”.", item: "ë°€í¬í‹°", isBad: false },
            { type: "ì†Œê¸¸ (å°å‰)", text: "ì‘ê³  ê·€ì—¬ìš´ í–‰ìš´ì´ ì°¾ì•„ì™€ìš”.<br>ê¸¸ ê°€ë‹¤ ì˜ˆìœ ê½ƒì„ ë°œê²¬í• ì§€ë„?", item: "ë‹¬ì½¤í•œ ì‚¬íƒ•", isBad: false },
            { type: "í‰ (å‡¶)", text: "ì˜¤ëŠ˜ì€ ì¡°ê¸ˆ ì¡°ì‹¬í•˜ëŠ” ê²Œ ì¢‹ê² ì–´ìš”.<br>í•˜ì§€ë§Œ ê±±ì • ë§ˆì„¸ìš”!<br>ì—¬ê¸°ì— ë¬¶ì–´ë‘ê³  ê°€ë©´ ì•¡ìš´ ë!", item: "ì†ìˆ˜ê±´", isBad: true }
        ];

        let selectedNumber = 0;
        let selectedFortune = {};
        let wires = [];

        function initWires() {
            const container = document.getElementById('wires-container');
            for (let i = 0; i < 3; i++) { 
                const wire = document.createElement('div');
                wire.className = 'wire';
                container.appendChild(wire);
                wires.push(wire);

                const initialPapers = Math.floor(Math.random() * 3) + 2;
                for (let j = 0; j < initialPapers; j++) {
                    createTiedPaper(wire, true);
                }
            }
        }
        initWires();

        function createTiedPaper(wireElement, isInitial = false) {
            const paper = document.createElement('div');
            paper.className = 'tied-paper';
            
            const leftPos = Math.floor(Math.random() * 80) + 10;
            const rotate = Math.random() * 30 - 15;
            paper.style.left = leftPos + '%';
            paper.style.transform = `translateY(-50%) rotate(${rotate}deg)`;

            if (isInitial) {
                paper.style.opacity = '1';
            } else {
                paper.style.opacity = '0';
                paper.style.transform = `translateY(-50%) scale(3)`;
            }
            wireElement.appendChild(paper);
            return paper;
        }

        function showScene(sceneId) {
            document.querySelectorAll('.scene').forEach(s => s.classList.remove('active'));
            document.getElementById(sceneId).classList.add('active');
        }

        function startShaking() {
            const box = document.getElementById('box');
            box.classList.add('shake-action');
            setTimeout(() => {
                box.classList.remove('shake-action');
                showScene('scene-stick');
            }, 1500);
        }

        function pickStick(element) {
            selectedNumber = Math.floor(Math.random() * 25) + 1;
            // 50% í™•ë¥ ë¡œ í‰
            if (Math.random() < 0.5) {
                selectedFortune = fortunes[4];
            } else {
                const goodIndex = Math.floor(Math.random() * 4);
                selectedFortune = fortunes[goodIndex];
            }
            
            element.style.transform = "translateY(-40px) rotate(10deg)";
            element.style.background = "#FFC1CC";
            setTimeout(() => {
                document.getElementById('stick-num-display').innerText = selectedNumber;
                createDrawers(selectedNumber);
                showScene('scene-drawer');
            }, 600);
        }

        function createDrawers(targetNum) {
            const grid = document.getElementById('drawer-grid');
            grid.innerHTML = '';
            for(let i=1; i<=25; i++) {
                const drawer = document.createElement('div');
                drawer.className = 'drawer';
                drawer.innerText = i;
                if(i === targetNum) {
                    drawer.onclick = () => openResult();
                    drawer.classList.add('target');
                } else {
                    drawer.onclick = () => {
                        drawer.style.backgroundColor = "#FF8BA7";
                        drawer.style.color = "#fff";
                        setTimeout(() => {
                            drawer.style.backgroundColor = "#FFF";
                            drawer.style.color = "#8D6E63";
                        }, 200);
                    };
                }
                grid.appendChild(drawer);
            }
        }

        function openResult() {
            document.getElementById('result-num').innerText = selectedNumber;
            document.getElementById('fortune-rank').innerText = selectedFortune.type;
            document.getElementById('fortune-text').innerHTML = selectedFortune.text;
            document.getElementById('lucky-item').innerText = selectedFortune.item;

            const badLuckArea = document.getElementById('bad-luck-action');
            const retryBtn = document.getElementById('retry-btn');
            
            if(selectedFortune.isBad) {
                document.getElementById('fortune-rank').style.color = "#888"; 
                badLuckArea.classList.remove('hidden');
                retryBtn.style.display = 'none';
            } else {
                document.getElementById('fortune-rank').style.color = "var(--deep-pink)";
                badLuckArea.classList.add('hidden');
                retryBtn.style.display = 'inline-block';
            }
            showScene('scene-result');
        }

        function tieBadLuck() {
            const resultPaper = document.getElementById('result-paper');
            const tieBtn = document.getElementById('tie-btn');

            resultPaper.style.transition = "all 0.8s ease";
            resultPaper.style.transform = "scale(0.1) translateY(100px)";
            resultPaper.style.opacity = "0";
            tieBtn.style.display = 'none';

            const randomWireIndex = Math.floor(Math.random() * wires.length);
            const newPaper = createTiedPaper(wires[randomWireIndex], false);

            setTimeout(() => {
                newPaper.style.transition = "all 0.4s cubic-bezier(0.2, 0.8, 0.2, 1.2)";
                newPaper.style.opacity = '1';
                newPaper.style.transform = `translateY(-50%) rotate(${Math.random() * 20 - 10}deg) scale(1)`;
                
                const actionArea = document.getElementById('bad-luck-action');
                actionArea.querySelector('p').innerText = "ì•¡ìš´ì´ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤! ğŸŒ¸";
                actionArea.querySelector('p').style.color = "var(--deep-pink)";
                document.getElementById('retry-btn').style.display = 'inline-block';
            }, 800);
        }
    </script>
</body>
</html>
